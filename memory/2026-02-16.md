# 2026-02-16 (Monday)

## OpenClaw Cron Bug - Confirmed & Documented

### Root Cause Identified
The OpenClaw cron scheduler has a critical bug:
- **Symptom:** Jobs have their `nextRunAtMs` advanced to the next occurrence without actually executing
- **No `lastRunAtMs`:** 13 of 14 enabled jobs show "lastRun=never" in the state object
- **Only exception:** BSR Check has `lastRunAtMs` because it was manually triggered via `cron run --force`

### Evidence
- Jobs stopped auto-executing around Feb 12 (4 days ago)
- Scheduler shows `enabled: true` with 15 jobs and correct `nextWakeAtMs`
- But no isolated sessions are created when jobs are due
- Run history (`cron action=runs`) shows empty `entries: []` for all jobs
- Log files show job configurations being dumped (from dashboard) but no execution events

### Jobs Affected (12 missed, 1 manual-only)
| Job | Last Should Run | Overdue |
|-----|-----------------|---------|
| Daily Rank Collection | Feb 15 7:00 AM | 24h |
| Daily Strategy Report | Feb 15 7:00 AM | 24h |
| Listing Monitor (Monday) | Feb 9 8:00 AM | 167h |
| SQP Retry | Feb 11 9:00 PM | 106h |
| GSC Weekly Report | Feb 9 9:00 AM | 166h |
| Rank Collection Retry | Feb 15 10:00 PM | 9h |
| Wholesale Pricing (12h) | Feb 16 6:00 AM | 1h |
| Facebook Canasta Scraper | Feb 15 10:30 PM | 8h |
| Daily Product Master Sync | Feb 16 5:30 AM | 1h |
| Daily Amazon Data Collection | Feb 16 6:00 AM | 1h |
| Daily PPC Collection | Feb 16 6:30 AM | 0.5h |
| Weekly SQP Collection | Feb 16 6:00 AM | 1h |

### Fixed Cron Watchdog
Updated `~/amazon-data/collectors/cron_watchdog.py` to detect missed jobs by:
1. Checking `lastRunAtMs` in job state
2. Comparing to calculated `last_should_run` from cron expression
3. Jobs with no lastRunAtMs or stale lastRunAtMs are flagged

### Manual Recoveries This Morning
- ✅ Daily Amazon Collection - running
- ✅ Daily PPC Collection - running  
- ✅ Daily Ranks Collection - completed (15 radars, ~1,400 keywords)
- ✅ Wholesale via launchd - completed at 6:00 AM (480 products, 2 repriced)

### launchd Fallbacks Working
- `com.all7s.wholesale-update` - runs at 6:00 AM / 6:00 PM, confirmed working
- Need to add more launchd fallbacks for: Daily Collection, PPC, Ranks, Strategy Report

## Next Steps
1. Wait for running jobs to complete
2. Create launchd fallbacks for remaining critical jobs
3. Report bug to OpenClaw Discord/GitHub
4. Consider gateway restart to see if it helps

## Additional Findings (8 AM Session)

### 8:00 AM Cron Test - FAILED
- Listing Monitor job (47b38a81-6441-4f7e-b93e-ca1dd5d9f5bc) was scheduled for 8:00 AM Monday
- Confirmed scheduler advanced `nextRunAtMs` without executing
- Run history still shows `entries: []`

### Model Error Discovered
At ~12:11 EST (prior session):
- Error: `"Unknown model: ollama/llama3.1:8b"`
- OpenClaw doesn't recognize Ollama models for isolated sessions
- This may be why cron jobs with agentTurn payloads don't execute
- Jobs are configured with `model: "ollama/llama3.1:8b"` which is invalid

### Cron Dashboard Created
- Location: `~/amazon-data/dashboard/`
- Serving: `http://192.168.68.200:8888`
- launchd service: `com.chloe.cron-dashboard`
- Trello-style view showing all cron jobs with status

### Manual Recoveries Completed
- ✅ Daily Amazon Collection: 335 orders processed
- ✅ Daily PPC Collection: completed
- ✅ Daily Ranks Collection: 15 radars, ~1,400 keywords
- ✅ Weekly SQP: completed
- ✅ Daily Product Master Sync: 16 products synced
- ✅ Strategy Report: 15 pending strategies

## Session Info
- OpenClaw version: 2026.2.3-1
- Model: claude-opus-4-5
